---
title: vercel/ogë¥¼ ì´ìš©í•´ ì´ˆê°„ë‹¨ ì¸ë„¤ì¼ ìƒì„±ê¸° ë§Œë“¤ê¸°(with Next.js)
description: ì˜¤í”ˆê·¸ë˜í”„ ì´ë¯¸ì§€ ìƒì„±ì„ ì§€ì›í•˜ëŠ” @vercel/ogë¥¼ ì‘ìš©í•´ ì¸ë„¤ì¼ ìƒì„± ì„œë¹„ìŠ¤ë¥¼ ë§Œë“¤ì–´ë³´ì
image: /images/blog/blog-post-3.jpg
date: "2023-11-15"
---

Vercelì—ì„œ ì œê³µí•˜ëŠ” ì˜¤í”ˆê·¸ë˜í”„ ìƒì„± ë¼ì´ë¸ŒëŸ¬ë¦¬ì¸ `@vercel/og` ë¼ëŠ”ê²Œ ìˆìŠµë‹ˆë‹¤. ë¸”ë¡œê·¸ë¥¼ í¬ìŠ¤íŒ… í•  ë•Œ og imageë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•˜ëŠ” ìš©ë„ë¡œ ì£¼ë¡œ ì“°ì´ëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤ë§Œ
ì´ë¥¼ ì‘ìš©í•˜ë©´ ì¸ë„¤ì¼ ìƒì„± ì„œë¹„ìŠ¤ë¥¼ ì‰½ê²Œ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ê²°ê³¼ë¬¼ ë¯¸ë¦¬ë³´ê¸°
[https://thumbnail-maker.vercel.app/](https://thumbnail-maker.vercel.app)   
ì¸ë„¤ì¼ì„ ìƒì„±í•˜ê³  png íŒŒì¼ë¡œ ë‹¤ìš´ë¡œë“œ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ì„œë¹„ìŠ¤ ì»¨ì…‰

ì œê°€ ì„¸ìš´ ê³„íšì€ ì•„ì£¼ ë‹¨ìˆœí•©ë‹ˆë‹¤. ë©”ì¸ í˜ì´ì§€ì— ì§„ì…í•˜ë©´, defaultë¡œ ì •ì˜ëœ ê°’ë“¤ë¡œ ì¸ë„¤ì¼ì„ ìƒì„±í•˜ê³ , ì´ë¥¼ previewë¡œ ë³´ì—¬ì¤ë‹ˆë‹¤.
ì‚¬ìš©ìëŠ” ì›í•˜ëŠ” ì œëª©, ì´ë¦„, ìƒ‰ìƒ, ë¹„ìœ¨ ë“±ì„ ì„ íƒí•˜ê³ , ê°ê°ì˜ ì´ë²¤íŠ¸ë§ˆë‹¤ ë³€ê²½ëœ ë‚´ìš©ì„ previewì— ë°˜ì˜í•©ë‹ˆë‹¤.
ì¸ë„¤ì¼ì„ ì™„ì„±í•œí›„ì— ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ì„ í´ë¦­í•´ ì¸ë„¤ì¼ì„ ë‹¤ìš´ë¡œë“œ ë°›ìŠµë‹ˆë‹¤.

--- ì—¬ê¸° mp4 ---

## ë©”ì¸í™”ë©´ UI ë° API í˜¸ì¶œí•˜ê¸°

```tsx app/page.tsx
"use client"
import { useEffect, useRef, useState } from 'react'
import { useDebounce } from "@/hooks/useDebounce"
import Image from 'next/image'
import Link from 'next/link'

export default function Home() {
  const [width, setWidth] = useState<number>(600)
  const [height, setHeight] = useState<number>(300)
  const [title, setTitle] = useState<string>("ì‰½ê³  í¸í•˜ê²Œ.             ì¸ë„¤ì¼ ë§Œë“¤ê¸° ğŸ˜€")
  const [name, setName] = useState<string>("@ì¸ë„¤ì¼ë©”ì´ì»¤")
  const [ratio, setRatio] = useState<string>("4:3")
  const [backgroundColor, setBackgroundColor] = useState<string>("#427BFF")
  const [textColor, setTextColor] = useState<string>("#000")
  const [imageSrc, setImageSrc] = useState<string>("")
  const backgroundColorRef = useRef<HTMLInputElement>(null)
  const colorRef = useRef<HTMLInputElement>(null)
  const debouncedTitleTerm: string = useDebounce<string>(title, 300)
  const debouncedNameTerm: string = useDebounce<string>(name, 300)  

  const loadImage = async () => {
    setWidth(width)
    setHeight(height)
    const data = await fetch(`/og?ratio=${ratio}&title=${title}&name=${name}&backgroundColor=${backgroundColor.replace('#', '')}
      &textColor=${textColor.replace('#', '')}`)
    const file = await data.blob()  
    setImageSrc(URL.createObjectURL(file))
  }

  const downloadThumbnail = async() => {
    const data = await fetch(`/og?ratio=${ratio}&title=${title}&name=${name}&backgroundColor=${backgroundColor.replace('#', '')}
      &textColor=${textColor.replace('#', '')}`)
    const file = await data.blob()
    const url = URL.createObjectURL(file)
    const a = document.createElement("a")
    a.setAttribute("download", 'thumbnail.png')
    a.setAttribute("href", url)
    document.body.appendChild(a)
    a.click()
    document.body.removeChild(a)
  }

  // eslint-disable-next-line react-hooks/exhaustive-deps
  useEffect(() => { loadImage() }, [backgroundColor, textColor, ratio, debouncedTitleTerm, debouncedNameTerm])

  return (
    <main className="m-auto min-h-screen max-w-[50rem] flex flex-col">
      <section>
        <div className='border-x-2 border-b-2 border-black flex justify-center bg-black h-[300px]'>
          { imageSrc ? 
          <Image className='max-w-full max-h-full object-contain' src={imageSrc} alt="thumbnail" width={width} height={height} /> 
          : null }     
        </div>
        <table className='w-full'>
          <thead></thead>
          <tbody>
            <tr className='border-b-2 border-x-2 border-black h-[70px]'>
              <td className='w-1/4 border-r-2 border-black text-center font-bold text-lg'>ë¹„ìœ¨</td>
              <td className={`${ratio === '4:3' ? 'bg-pink-300 text-white' : '' } w-1/4 border-r-2 border-black text-center cursor-pointer`} onClick={() => setRatio('4:3')}>
                4:3
              </td>
              <td className={`${ratio === '2:1' ? 'bg-pink-300 text-white' : '' } w-1/4 border-r-2 border-black text-center cursor-pointer`} onClick={() => setRatio('2:1')}>
                2:1
              </td>
              <td className={`${ratio === '1:1' ? 'bg-pink-300 text-white' : '' } w-1/4 border-r-2 border-black text-center cursor-pointer`} onClick={() => setRatio('1:1')}>
                1:1
              </td>
            </tr>
            <tr className='border-b-2 border-x-2 border-black h-[70px]'>
              <td className='w-1/4 border-r-2 border-black text-center font-bold text-lg'>ì œëª©</td>
              <td className='border-r-2 border-black text-center' colSpan={3}>
                <input className='w-full h-[70px] px-4 outline-none' value={title} onChange={(event) => setTitle(event.target.value)} />
              </td>
            </tr>
            <tr className='border-b-2 border-x-2 border-black h-[70px]'>
              <td className='w-1/4 border-r-2 border-black text-center font-bold text-lg'>ì´ë¦„</td>
              <td className='border-r-2 border-black text-center' colSpan={3}>
                <input className='w-full h-[70px] px-4 outline-none' value={name} onChange={(event) => setName(event.target.value)} />
              </td>
            </tr>
            <tr className='border-b-2 border-x-2 border-black h-[70px]'>
              <td className='w-1/4 border-r-2 border-black text-center font-bold text-lg'>ë°°ê²½ìƒ‰</td>
              <td className='border-r-2 border-black text-center' style={{ backgroundColor: `${backgroundColor}` }}>
                <div className={`w-full h-[70px] bg-[${backgroundColor}]`} onClick={() => backgroundColorRef.current?.click()}></div>
                <input type="color" className='h-0 w-0 absolute' value={backgroundColor} onChange={(event) => setBackgroundColor(event.target.value)} ref={backgroundColorRef} />
              </td>
              <td className='w-1/4 border-r-2 border-black text-center font-bold text-lg'>ê¸€ììƒ‰</td>
              <td className='border-r-2 border-black text-center' style={{ backgroundColor: `${textColor}` }}>
                <div className={`w-full h-[70px] bg-[${textColor}]`} onClick={() => colorRef.current?.click()}></div>
                <input type="color" className='h-0 w-0 absolute' value={textColor} onChange={(event) => setTextColor(event.target.value)} ref={colorRef} />
              </td>
            </tr>
            <tr className='border-b-2 border-x-2 border-black h-[75px]'>
              <td 
                className='text-center font-black bg-orange-300 text-white text-xl cursor-pointer hover:bg-gray-400' 
                style={{ WebkitTextStroke: '1px black' }}
                colSpan={4} 
                onClick={downloadThumbnail}>ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ(PNG)</td>
            </tr>
          </tbody>
        </table>
      </section>
    </main>
  )
}
```
ìµœì´ˆ ì§„ì…ì‹œ ë° ì¸ë„¤ì¼ì˜ ë¹„ìœ¨, ì œëª©, ì´ë¦„, ìƒ‰ìƒë“±ì„ ì…ë ¥ë°›ê³  ë³€ê²½ ë  ì‹œ `loadImage` í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤. `loadImage` í•¨ìˆ˜ ë‚´ë¶€ì—ì„  og imageë¥¼ ì‘ë‹µ ë°›ëŠ” apië¥¼ í˜¸ì¶œ
í•˜ì—¬ imageë¥¼ ì‘ë‹µ ë°›ê³ , `setImageUrl` í›…ì„ í˜¸ì¶œí•´ ë³€ê²½ëœ ì¸ë„¤ì¼ ì´ë¯¸ì§€ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤. ì œëª©ê³¼ ì´ë¦„ì˜ ê²½ìš°ì—” debounceë¥¼ ê±¸ì–´ì¦ì€ api í˜¸ì¶œì„ ë°©ì§€í•´ë‘¡ë‹ˆë‹¤.

--- ì—¬ê¸° page.tsx UI ì´ë¯¸ì§€ ---


## OG Image Response API ë§Œë“¤ê¸°

```tsx app/og/route.tsx
import { ImageResponse } from 'next/server'
 
export const runtime = 'edge'
 
export async function GET(request: Request) {
  const { searchParams } = new URL(request.url)
  const ratio = searchParams.get('ratio')
  const title = searchParams.get('title')
  const name = searchParams.get('name')
  const backgroundColor = searchParams.get('backgroundColor')
  const textColor = searchParams.get('textColor')

  const fontData = await fetch(
    new URL('@/public/SpoqaHanSansNeo-Bold.woff', import.meta.url),
  ).then((res) => res.arrayBuffer())  

  let width = 600
  let height = 300
  if (ratio === '4:3') {
    width = 600
    height = 450
  }
  if (ratio === '2:1') {
    width = 600
    height = 300
  }
  if (ratio === '1:1') {
    width = 600
    height = 600
  }

  return new ImageResponse(
    (
      <div 
        tw={`h-full w-full flex justify-center`} 
        style={{ alignItems: 'center', backgroundColor: `#${backgroundColor}`, color: `#${textColor}`, fontFamily: 'SpoqaHanSansNeo' }}
      >
        <div tw="flex absolute left-[24px] top-[24px]">
          <span>{name}</span>
        </div>        
        <h1 tw="flex justify-center text-6xl leading-normal" style={{ whiteSpace: 'pre-wrap', padding: '40px' }}>{title}</h1>
      </div>
    ),
    {
      width: width,
      height: height,
      fonts: [
        {
          name: 'SpoqaHanSansNeo',
          data: fontData,
          style: 'normal',
        },
      ],      
    },
  )
}
```
`@vercel/og`ëŠ” Next.js 13ì˜ App Routerë¥¼ ì‚¬ìš©í•œë‹¤ë©´ ë”°ë¡œ ì„¤ì¹˜í•˜ì§€ ì•Šì•„ë„ ì‚¬ìš©ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.
